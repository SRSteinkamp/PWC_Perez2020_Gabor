---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "experiments.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: experiments.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">pwc_gabor_layer.core</span> <span class="kn">import</span> <span class="n">GaborLayer</span>
<span class="kn">import</span> <span class="nn">tensorflow_datasets</span> <span class="k">as</span> <span class="nn">tfds</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="First-load-mnist">First load mnist<a class="anchor-link" href="#First-load-mnist"> </a></h2><p>Data processing as in the tensorflow datasets tutorial, this is just for an example. And more specifically for fixing issues with backpropagtion!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">ds_train</span><span class="p">,</span> <span class="n">ds_test</span><span class="p">),</span> <span class="n">ds_info</span> <span class="o">=</span> <span class="n">tfds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;mnist&#39;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">shuffle_files</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                         <span class="n">as_supervised</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">normalize_img</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Normalizes images: `uint8` -&gt; `float32`.&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.</span><span class="p">,</span> <span class="n">label</span>

<span class="n">ds_train</span> <span class="o">=</span> <span class="n">ds_train</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="n">normalize_img</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">ds_train</span> <span class="o">=</span> <span class="n">ds_train</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="n">ds_train</span> <span class="o">=</span> <span class="n">ds_train</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">ds_info</span><span class="o">.</span><span class="n">splits</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num_examples</span><span class="p">)</span>
<span class="n">ds_train</span> <span class="o">=</span> <span class="n">ds_train</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="n">ds_train</span> <span class="o">=</span> <span class="n">ds_train</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">AUTOTUNE</span><span class="p">)</span>

<span class="n">ds_test</span> <span class="o">=</span> <span class="n">ds_test</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="n">normalize_img</span><span class="p">,</span> <span class="n">num_parallel_calls</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<span class="n">ds_test</span> <span class="o">=</span> <span class="n">ds_test</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="n">ds_test</span> <span class="o">=</span> <span class="n">ds_test</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="n">ds_test</span> <span class="o">=</span> <span class="n">ds_test</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">AUTOTUNE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some MNIST examples.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds_viz</span><span class="p">,</span> <span class="n">viz_info</span> <span class="o">=</span> <span class="n">tfds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;mnist&#39;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">shuffle_files</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                         <span class="n">as_supervised</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">tfds</span><span class="o">.</span><span class="n">show_examples</span><span class="p">(</span><span class="n">ds_viz</span><span class="p">,</span> <span class="n">viz_info</span><span class="p">);</span>

<span class="c1"># Some settings for later</span>
<span class="n">ds_viz</span> <span class="o">=</span> <span class="n">ds_viz</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ds_viz</span> <span class="o">=</span> <span class="n">ds_viz</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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OQ0lzZJ0XFpzFlCyzGyOpFOcc5srmdNF0lXOufMKtzKgeri2k6EgyIKZHSJp3/R/1xqY015SK+fcawVbGFANZnaMpK3OuYWVzOknablzbmXBFgZUE9d2MhQEAACAHgIAAEBBAAAAREEAAABEQQAAAERBAAAAREEAAABEQQAAAERBAAAAREEAAABEQQAAAERBAAAAREEAAABEQQAAAERBAAAAREEAAABEQQAAAERBAAAAREEAAABEQQAAAERBAAAAREEAAABEQQAAAERBAAAAREEAAABEQQAAAERBAAAAREEAAABEQQAAACTVr8pkM3P5WghqLuecFXsN1cF1jQpscM7tXexFVAfXNkIqes/mDgEAhK0q9gKAQqIgAAAAFAQAAICCAAAAiIIAAACIggAAAIiCAAAAiIIAAACIggAAAIiCAAAAiIIAAACIggAAAIiCAAAAqIpPO0T19evXz8uGDx/uZQMGDPCyMWPGRMY//elPc7cwAECdxh0CAABAQQAAACgIAACAKAgAAIBoKsypli1betlJJ50UGY8dO9abs8cee3iZc87LRo4cGRkvX77cm/PQQw9lXCcgSQ0aNPCyhg0bJjr2hBNOiIxvuukmb86RRx6Z6FzxY2+77bZExwH5EH/vHT16tDfn5ptvLtBqCos7BAAAgIIAAABQEAAAAFEQAAAA0VSYSJMmTbxs0KBBXnbhhRd62Xe/+92craNevXqRcdOmTXN2bhRW/P/lIYcc4s259NJL87qGjh07elmPHj28zMy8LNT0ms0cSTrmmGMSzQNyLUlzYK9evfK/kBLBHQIAAEBBAAAAKAgAAIAoCAAAgGgqTOTFF1/0su7du3tZkuarsrIyb87dd9/tZaFHIm/atCkyvueee/zFokbYZ599IuOFCxcWaSWFtXXrVi+bPHlyEVYCJHP88ccXewkFwx0CAABAQQAAACgIAACA6CHQoYceGhlPmTLFm9OmTZusz79x48bI+JJLLvHmPPfcc14WenLixIkTs14HUApGjRrlZePHjy/CSoC6telQEtwhAAAAFAQAAICCAAAAiIIAAACojjUV1q/v/3Yvu+yyyLhdu3ZZn3/16tVeduWVV0bGoQbCkNCTE1F7xJtNQ411gwcPzvr8b7/9dmQcb56VpN122y3r88eFNhwKNRA+9thjOXtNoCpCGwwl2XRo9OjRuV9MieIOAQAAoCAAAAAUBAAAQBQEAABAtbipMNREFW8glKQhQ4bk7DXbtm2bs3Ohdos/9fLyyy/35jzyyCNZn3/BggWR8fz58705Bx10UNbnT7J+diBEKalLTy3MFncIAAAABQEAAKAgAAAAoiAAAACqxU2FoYapbBsIX3nlFS8bN25cVucCQkI7/c2ZMyfr88Wb/KrzCO/t27d72bBhwyLj6jRAAqXs5ptvLvYSCoY7BAAAgIIAAABQEAAAAFEQAAAASeacSz7ZLPnkIpsxY4aX9erVK+Nxmzdv9rK+fft6WXwnuLrMOWfFXkN11KTrOiS0A+edd94ZGTdo0CDr819wwQVeNmHChKzPV4PMd84dXexFVEdNv7ZzKenPutdeey0y7t27dx5WU1wVvWdzhwAAAFAQAAAACgIAAKBavDHRgQcemNVx559/vpfRL4BSMXz4cC8bM2aMl+266645e8060i+AWqQ6mwnVxp6BpLhDAAAAKAgAAAAFAQAAEAUBAABQLWkqvP76671s//33z+pcf/7zn7NeR4cOHbysR48eGY876aSTvGzAgAEZj5syZYqXnXXWWV62bdu2jOdC6TnttNO8bMSIEV6WywbCkND3VxLPPvusly1ZsqS6ywEyuummm4q9hBqJOwQAAICCAAAAUBAAAABREAAAANXApx3Wr+/3QY4bN87L/vd//zfR+e65557I+Nprr/XmhJoFmzZt6mVPPPGEl7Vo0SLROnJlzz339LItW7bk9TV52mH1tWvXzsuWLl1ahJX4dtnF/3vDjh07sjrXk08+6WWjRo2KjFesWJHVufOApx3WUFX5uRZnVqPfzhLhaYcAAKBCFAQAAICCAAAAUBAAAADVwJ0Kv/Wtb3lZ0gbCkHjDXZ8+fbw5oce/fvvb3/ayUDNKkuaWsrIyLwvtPhdq7kLtVZ3GqFwKNRBmu7YzzzzTy7p27RoZn3766d6cxYsXe9n27duzWgNql+o86nj06NG5W0gtwE8YAABAQQAAACgIAACAKAgAAIBq4E6Fe+yxh5dt3LixCCvxJWkqnDp1qjfn/vvv97IHHnjAy9q0aZNxDexUWHWlcF3vvvvuXjZ06FAvGzx4sJc1btw44/kaNmzozfn3v//tZRs2bPCy0HUdb6oNfV/mUrdu3bxs3rx5eX1NsVNhSTr++OMj45kzZ2Z9rrqwK2EIOxUCAIAKURAAAAAKAgAAUAM3Jipl06ZN87Lf/va3kXHoKYnf//73vWy//fbL+HpLlizxMjZrqZlCfR533nlnoiz0RM22bdtGxs2aNfPmrF271ssWLFhQ2TJ36ty5c2T8ve99z5szcuRILzvkkEMSnT/uhhtu8LKzzjrLy7788suszo+aI95DkBSbEGXGHQIAAEBBAAAAKAgAAIAoCAAAgNiYKJFQo9LYsWO97Je//KWXnXjiiZHxk08+mfU6li5dGhmfeuqp3pz3338/6/Nni42JEBJqjH3ttde87MADD8zq/K1atfKyTz/9NKtzVYCNiUpQfCOipE2GvXv39rLQ9VgXsDERAACoEAUBAACgIAAAABQEAABA7FSYyObNmxPNe+qpp7ysX79+OVvHT37yk8i4GA2EyI340wdPP/10b86QIUO8bPXq1V72m9/8xssK8CTAiI4dO3rZNddc42XZNhCuWbPGy7Zt25bVuVBzhBoGs92psK42EFYFdwgAAAAFAQAAoCAAAACiIAAAAKqBTYVmhd8Ub++99/ay6667zst22cWvr3bs2JHx/IsXL/ayxx9/3MteeeWVjOdCzXD11VdHxkkfzdq9e3cvO+WUU7zsgw8+iIwXLlzozXnxxRcTveb111/vZfEdTtu0aePNad68eaLzJ3Huued62aZNm3J2fpSmbBsIkR3uEAAAAAoCAABAQQAAAFQDewg+//xzL+vZs6eXhTZr6dKlS17W9LUkT45ctmyZl4WeWrhq1aqcrAmlaZ999snZuZo2beplnTp1qnQsSeedd16i84f6dqrylNRM4psO3Xvvvd6cN998M2evh5qjV69eOTvXzTffnCiry7hDAAAAKAgAAAAFAQAAEAUBAABQDWwq3L59u5f95S9/8bIf/vCHXvb888972RFHHJGbhUmaPXu2l02aNCkynj59ujeHBkLUFVOnTvWyG2+8MTJetGhRoZaDEpfLjYl42mFm3CEAAAAUBAAAgIIAAACIggAAAEiyquw4Zma5254MtYZzrvCPoMyhYlzXDRs2jIzr10/W3/ujH/3Iyw488MCMxw0ZMsTL9txzz0SvGWqWjTfybt682Ztz//33e1lZWZmXhRqFS8R859zRxV5EddT09+xsd8QsxlNxa5KK3rO5QwAAACgIAAAABQEAABAFAQAAEE2FyAGaClFL0VSIWommQgAA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Yrj44osj49///veJjtu4caOX3X777TlZEwqvS5cuXhbasTWJpNdQTXLKKadExhdddJE3J+mfV7Z/rlXBHQIAAEBBAAAAKAgAAIAoCAAAgGgq1IknnhgZX3fddYmO27Ztm5cNHDjQy/74xz9mtzCgRLRu3drLrrjiiqzOdemll3pZaKdO1D2h5uqarn///jk714oVK3J2ropwhwAAAFAQAAAACgIAACAKAgAAoDrWVBjaJep3v/tdZBxq3Fi3bp2Xffe73/WyXXfdtRqrA0rTM88842UdOnTIeNz999/vZc8991xO1oTScNRRR2V13FtvveVln3zySXWXU1Q33nijl4V+5iSxbNkyLytE0yV3CAAAAAUBAACgIAAAAKolPQT77ruvl40ZM8bLQptExD/jefzxx705+++/v5eNHz/ey+69914ve/PNNyPjtWvXenOAUnHcccd5WadOnTIe9/rrr3vZ0KFDc7ImlK5evXp5WZKn8s2ePTsfyymYUA9NaNOt+BNwzcybE9rkbtCgQV72z3/+sypLzAp3CAAAAAUBAACgIAAAAKIgAAAAqoFNhfEmDSm8iUOoeaNPnz5eNm/evIyvGdqsaNy4cV4W2jjimGOOiYynTJmS8fWAQjj66KO97NVXX/WyBg0aeNnEiRMj42HDhuVuYagxQg2ESZoKk8wpFaEGwmnTpnlZqLk9/vsMNRCOHDnSy0IbNxUCdwgAAAAFAQAAoCAAAACiIAAAAKoBTYXxJwiGdrgqKyvzshNPPNHLFixYkLN17bXXXonmbdiwIWevCWRrl1382v/RRx/1slAD4dy5c70s3kS4efPmaqwONdXy5cu9rF27dkVYSe7En1oY2oEw1ECYxGWXXeZlDz74YFbnygfuEAAAAAoCAABAQQAAAERBAAAAVGJNhd/+9re97NZbb42M4zv/SdKxxx7rZblsIGzYsKGXnXfeeV4W2oUqtIsiUGihx3UfdthhXrZlyxYvu/rqq72MJkJI4R37rrjiiiKsJLNTTjnFy37+8597WZcuXSLj0O64SXdajDffllIDYQh3CAAAAAUBAACgIAAAACqxHoLQJj6NGzeOjDdu3OjNadSokZeFPvcJ6dy5c2Tcpk0bb87YsWO9LDTvlltu8bL169cnWgeQS8OHD4+Mzz///ETH/d///Z+XzZkzJydrQu3z+eefe1noSbNx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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Apply-kernel-to-MNIST">Apply kernel to MNIST<a class="anchor-link" href="#Apply-kernel-to-MNIST"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GL</span> <span class="o">=</span> <span class="n">GaborLayer</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">orientations</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">use_alphas</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">GL</span><span class="o">.</span><span class="n">build</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get a single element of MNIST dataset</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">one_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ds_viz</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;image&#39;</span><span class="p">]</span>

<span class="n">blub</span> <span class="o">=</span> <span class="n">GL</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">one_batch</span><span class="p">[:</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>

<span class="n">n1</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">141</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">one_batch</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">142</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">n1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">143</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">n2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">n1</span><span class="p">]</span><span class="o">-</span><span class="n">blub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">n2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x1be7a7f3fc8&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_gl</span> <span class="o">=</span>  <span class="n">GaborLayer</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">orientations</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> 
                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_alphas</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">learn_orientations</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
                        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">([</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
                        <span class="n">test_gl</span><span class="p">,</span>
                         <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
                        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: &#34;sequential_2&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
gabor_layer_3 (GaborLayer)   (None, 28, 28, 16)        178       
_________________________________________________________________
flatten_2 (Flatten)          (None, 12544)             0         
_________________________________________________________________
dense_2 (Dense)              (None, 10)                125450    
=================================================================
Total params: 125,628
Trainable params: 125,530
Non-trainable params: 98
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds_train</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="n">ds_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>469/469 [==============================] - 15s 33ms/step - loss: 16.4538 - accuracy: 0.7341 - val_loss: 6.2136 - val_accuracy: 0.8522
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tensorflow.python.keras.callbacks.History at 0x1be10f2a548&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">kernel</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ds_viz</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;image&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ds_viz</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_gradient</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1">#taping the gradients</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="c1">#model predictions</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1">#getting the loss</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">sparse_categorical_crossentropy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>

    <span class="n">grads</span> <span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grads</span>

<span class="n">grads</span> <span class="o">=</span> <span class="n">get_gradient</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="c1">#print(tf.math.reduce_mean(g).numpy())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>gabor_layer_3/gammas:0
tf.Tensor(
[[[[[-0.]]]]



 [[[[-0.]]]]



 [[[[-0.]]]]



 [[[[-0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[-0.]]]]



 [[[[-0.]]]]



 [[[[ 0.]]]]



 [[[[-0.]]]]



 [[[[ 0.]]]]



 [[[[-0.]]]]], shape=(16, 1, 1, 1, 1), dtype=float32)
--------------------------------------------------
gabor_layer_3/psis:0
tf.Tensor(
[[[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]], shape=(16, 1, 1, 1, 1), dtype=float32)
--------------------------------------------------
gabor_layer_3/sigmas:0
tf.Tensor(
[[[[[-0.]]]]



 [[[[-0.]]]]



 [[[[-0.]]]]



 [[[[ 0.]]]]



 [[[[-0.]]]]



 [[[[ 0.]]]]



 [[[[-0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[ 0.]]]]



 [[[[-0.]]]]



 [[[[-0.]]]]



 [[[[-0.]]]]



 [[[[-0.]]]]], shape=(16, 1, 1, 1, 1), dtype=float32)
--------------------------------------------------
gabor_layer_3/lambdas:0
tf.Tensor(
[[[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]



 [[[[0.]]]]], shape=(16, 1, 1, 1, 1), dtype=float32)
--------------------------------------------------
gabor_layer_3/thetas:0
tf.Tensor(
[[[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]


 [[[0.]]]], shape=(16, 1, 1, 1), dtype=float32)
--------------------------------------------------
dense_2/kernel:0
tf.Tensor(
[[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]], shape=(12544, 10), dtype=float32)
--------------------------------------------------
dense_2/bias:0
tf.Tensor([0. 0. 0. 0. 0. 0. 0. 0. 0. 0.], shape=(10,), dtype=float32)
--------------------------------------------------
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[:</span><span class="mi">16</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">test_gl</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="n">n</span><span class="p">,:,:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">16</span><span class="p">:]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="n">n</span><span class="p">,:,:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

