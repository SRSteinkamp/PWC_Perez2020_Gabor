---

title: core


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Gabor-Layer-Math">Gabor Layer Math<a class="anchor-link" href="#Gabor-Layer-Math"> </a></h1><p>{% raw %}
$$G_\theta(x',y';\sigma,\gamma,\lambda,\psi):=e^{-\frac{(x'^2+\gamma^2y'^2)}{\sigma^2}}cos(\lambda x' + \psi)$$
{% endraw %}
{% raw %}
$$x' = x cos\theta - y sin\theta$$
{% endraw %}
{% raw %}
$$y' = x sin\theta + y cos\theta$$
{% endraw %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GaborLayer" class="doc_header"><code>class</code> <code>GaborLayer</code><a href="https://github.com/SRSteinkamp/pwc_gabor_layer/tree/main/pwc_gabor_layer/core.py#L19" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GaborLayer</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>Layer</code></p>
</blockquote>
<p>This is the class from which all layers inherit.</p>
<p>A layer is a callable object that takes as input one or more tensors and
that outputs one or more tensors. It involves <em>computation</em>, defined
in the <code>call()</code> method, and a <em>state</em> (weight variables), defined
either in the constructor <code>__init__()</code> or in the <code>build()</code> method.</p>
<p>Users will just instantiate a layer and then treat it as a callable.</p>
<p>Arguments:
  trainable: Boolean, whether the layer's variables should be trainable.
  name: String name of the layer.
  dtype: The dtype of the layer's computations and weights (default of
    <code>None</code> means use <code>tf.keras.backend.floatx</code> in TensorFlow 2, or the type
    of the first input in TensorFlow 1).
  dynamic: Set this to <code>True</code> if your layer should only be run eagerly, and
    should not be used to generate a static computation graph.
    This would be the case for a Tree-RNN or a recursive network,
    for example, or generally for any layer that manipulates tensors
    using Python control flow. If <code>False</code>, we assume that the layer can
    safely be used to generate a static computation graph.</p>
<p>Attributes:
  name: The name of the layer (string).
  dtype: The dtype of the layer's computations and weights. If mixed
    precision is used with a <code>tf.keras.mixed_precision.experimental.Policy</code>,
    this is instead just the dtype of the layer's weights, as the computations
    are done in a different dtype.
  trainable_weights: List of variables to be included in backprop.
  non_trainable_weights: List of variables that should not be
    included in backprop.
  weights: The concatenation of the lists trainable_weights and
    non_trainable_weights (in this order).
  trainable: Whether the layer should be trained (boolean), i.e. whether
    its potentially-trainable weights should be returned as part of
    <code>layer.trainable_weights</code>.
  input_spec: Optional (list of) <code>InputSpec</code> object(s) specifying the
    constraints on inputs that can be accepted by the layer.</p>
<p>We recommend that descendants of <code>Layer</code> implement the following methods:</p>
<ul>
<li><code>__init__()</code>: Defines custom layer attributes, and creates layer state
variables that do not depend on input shapes, using <code>add_weight()</code>.</li>
<li><code>build(self, input_shape)</code>: This method can be used to create weights that
depend on the shape(s) of the input(s), using <code>add_weight()</code>. <code>__call__()</code>
will automatically build the layer (if it has not been built yet) by
calling <code>build()</code>.</li>
<li><code>call(self, *args, **kwargs)</code>: Called in <code>__call__</code> after making sure
<code>build()</code> has been called. <code>call()</code> performs the logic of applying the
layer to the input tensors (which should be passed in as argument).
Two reserved keyword arguments you can optionally use in <code>call()</code> are:<ul>
<li><code>training</code> (boolean, whether the call is in
inference mode or training mode)</li>
<li><code>mask</code> (boolean tensor encoding masked timesteps in the input, used
in RNN layers)</li>
</ul>
</li>
<li><code>get_config(self)</code>: Returns a dictionary containing the configuration used
to initialize this layer. If the keys differ from the arguments
in <code>__init__</code>, then override <code>from_config(self)</code> as well.
This method is used when saving
the layer or a model that contains this layer.</li>
</ul>
<p>Examples:</p>
<p>Here's a basic example: a layer with two variables, <code>w</code> and <code>b</code>,
that returns <code>y = w . x + b</code>.
It shows how to implement <code>build()</code> and <code>call()</code>.
Variables set as attributes of a layer are tracked as weights
of the layers (in <code>layer.weights</code>).</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleDense</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">SimpleDense</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

  <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">):</span>  <span class="c1"># Create the state of the layer (weights)</span>
    <span class="n">w_init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random_normal_initializer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
        <span class="n">initial_value</span><span class="o">=</span><span class="n">w_init</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">),</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">),</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">b_init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros_initializer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
        <span class="n">initial_value</span><span class="o">=</span><span class="n">b_init</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">),</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>  <span class="c1"># Defines the computation from inputs to outputs</span>
      <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>

<span class="c1"># Instantiates the layer.</span>
<span class="n">linear_layer</span> <span class="o">=</span> <span class="n">SimpleDense</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># This will also call `build(input_shape)` and create the weights.</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">linear_layer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">linear_layer</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

<span class="c1"># These weights are trainable, so they&#39;re listed in `trainable_weights`:</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">linear_layer</span><span class="o">.</span><span class="n">trainable_weights</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
<p>Note that the method <code>add_weight()</code> offers a shortcut to create weights:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleDense</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">SimpleDense</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

  <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">),</span>
                               <span class="n">initializer</span><span class="o">=</span><span class="s1">&#39;random_normal&#39;</span><span class="p">,</span>
                               <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,),</span>
                               <span class="n">initializer</span><span class="o">=</span><span class="s1">&#39;random_normal&#39;</span><span class="p">,</span>
                               <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
</pre></div>
<p>Besides trainable weights, updated via backpropagation during training,
layers can also have non-trainable weights. These weights are meant to
be updated manually during <code>call()</code>. Here's a example layer that computes
the running sum of its inputs:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ComputeSum</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">ComputeSum</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
      <span class="c1"># Create a non-trainable weight.</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">initial_value</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">input_dim</span><span class="p">,)),</span>
                               <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="o">.</span><span class="n">assign_add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total</span>

<span class="n">my_sum</span> <span class="o">=</span> <span class="n">ComputeSum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">my_sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>  <span class="c1"># [2. 2.]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">my_sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>  <span class="c1"># [4. 4.]</span>

<span class="k">assert</span> <span class="n">my_sum</span><span class="o">.</span><span class="n">weights</span> <span class="o">==</span> <span class="p">[</span><span class="n">my_sum</span><span class="o">.</span><span class="n">total</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">my_sum</span><span class="o">.</span><span class="n">non_trainable_weights</span> <span class="o">==</span> <span class="p">[</span><span class="n">my_sum</span><span class="o">.</span><span class="n">total</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">my_sum</span><span class="o">.</span><span class="n">trainable_weights</span> <span class="o">==</span> <span class="p">[]</span>
</pre></div>
<p>For more information about creating layers, see the guide
<a href="https://www.tensorflow.org/guide/keras/custom_layers_and_models">Writing custom layers and models with Keras</a></p>
<p>About the layer's <code>dtype</code> attribute:</p>
<p>Each layer has a dtype, which is typically the dtype of the layer's
computations and variables. A layer's dtype can be queried via the
<code>Layer.dtype</code> property. The dtype is specified with the <code>dtype</code> constructor
argument. In TensorFlow 2, the dtype defaults to <code>tf.keras.backend.floatx()</code>
if no dtype is passed. <code>floatx()</code> itself defaults to "float32". Additionally,
layers will cast their inputs to the layer's dtype in TensorFlow 2. When mixed
precision is used, layers may have different computation and variable dtypes.
See <code>tf.keras.mixed_precision.experimental.Policy</code> for details on layer
dtypes.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GT</span> <span class="o">=</span> <span class="n">GaborLayer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">GT</span><span class="o">.</span><span class="n">total_filters</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">GT</span> <span class="o">=</span> <span class="n">GaborLayer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">GT</span><span class="o">.</span><span class="n">total_filters</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GaborLayer.create_xy_grid" class="doc_header"><code>GaborLayer.create_xy_grid</code><a href="https://github.com/SRSteinkamp/pwc_gabor_layer/tree/main/pwc_gabor_layer/core.py#L46" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GaborLayer.create_xy_grid</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test the outputs size of the meshgrid.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kernel_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">GaborLayer</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">orientations</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">create_xy_grid</span><span class="p">()</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">)</span>

<span class="n">kernel_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">GaborLayer</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">orientations</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">create_xy_grid</span><span class="p">()</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GaborLayer.build" class="doc_header"><code>GaborLayer.build</code><a href="https://github.com/SRSteinkamp/pwc_gabor_layer/tree/main/pwc_gabor_layer/core.py#L57" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GaborLayer.build</code>(<strong><code>batch_input_shape</code></strong>)</p>
</blockquote>
<p>Creates the variables of the layer (optional, for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <code>Layer</code> or <code>Model</code>
can override if they need a state-creation step in-between
layer instantiation and layer call.</p>
<p>This is typically used to create the weights of <code>Layer</code> subclasses.</p>
<p>Arguments:
  input_shape: Instance of <code>TensorShape</code>, or list of instances of
    <code>TensorShape</code> if the layer expects a list of inputs
    (one instance per input).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>nn_ops.convolution_v2<span class="o">?</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GaborLayer.create_kernel" class="doc_header"><code>GaborLayer.create_kernel</code><a href="https://github.com/SRSteinkamp/pwc_gabor_layer/tree/main/pwc_gabor_layer/core.py#L107" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GaborLayer.create_kernel</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GaborLayer.call" class="doc_header"><code>GaborLayer.call</code><a href="https://github.com/SRSteinkamp/pwc_gabor_layer/tree/main/pwc_gabor_layer/core.py#L142" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GaborLayer.call</code>(<strong><code>X</code></strong>)</p>
</blockquote>
<p>This is where the layer's logic lives.</p>
<p>Note here that <code>call()</code> method in <code>tf.keras</code> is little bit different
from <code>keras</code> API. In <code>keras</code> API, you can pass support masking for
layers as additional arguments. Whereas <code>tf.keras</code> has <code>compute_mask()</code>
method to support masking.</p>
<p>Arguments:
    inputs: Input tensor, or list/tuple of input tensors.
    **kwargs: Additional keyword arguments. Currently unused.</p>
<p>Returns:
    A tensor or list/tuple of tensors.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GL</span> <span class="o">=</span> <span class="n">GaborLayer</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">orientations</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">use_alphas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">GL</span><span class="o">.</span><span class="n">build</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>


<span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="n">n</span><span class="p">,:,:,</span><span class="n">jj</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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t2dxX/7ECamOuC+PvXaqXkfPvBPxxZ91/4obUMm3omORRXsxsZ4UrkpetM4pi/ZsrFd0DlmMoAAASaKDAgAkqdHrpfUFdwAASIygAACJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkk4d9sNf+dc/62Xtb8x96rZ/c+ojSdL18c/dtqtjp1271Tzj2ju9jmvf72xKkm7uPOW2/ef6S6797w9edO2PPptz7XM3+/d3eX7bbTv94/927be7P2gc9jqs5Z9fda/pcdc/t6VO//nf6/jndmd71rU/3brk2+t+++2VC5KkxeUpt627OO7aEw/8Z4DWfffQmry72992a9lt69z82LVjXlN34aVeeK+j15z7WanXZF/Pv2xMuO0/enRdkvRfD77ktt3/wr9fzQf+vBt/6I/7xMP+3U0sd/3Pl3dd+8xjf141VzZdu7G2IUnqbfhtvU3f/tHG31d6j7678Jrb/k8fviJJOnWz5bZN3/Jv5/TttmufvvfI3+HikiSps7JmHsSfz43T/lg0z/tjpMszkqTNa9Nu08pz/tfA/N/+aanXZK+jVsM/1unG2IF9Oz1/3Dd7/livdv17sNTt326hM+m23dnJv/4+Wfft26v96+/+I3/9bT/058xnf/zd0u/Ra3/y/WNxHZV9jyTpxb/yr2l80d9sYmnvmnhkr4kd1z71aMu1m6sbrp13TXS3/L69bf/+qpdzOJv+/Gie8X1G0bXECAoAkCQ6KABAkg6N+E4iG0eoaaIdZcPbx/7nZtcYi6bd1rj5n/08kB36C/656UVVYSOjlH1vLryPlB/rST7ai4n1JB/txcR6ko8xbKzX3fYxyCiz8bi9jlp7F42N+sYa/n05ay+qfR+Ps/dmTU/qfsXbTX+2G97pmMmL9SQf7cXEepK/JqJiPclFezbWa5w9G3z+jKAAAEmigwIAJGnkIj4bPbSUF/fZCGcYcZ99Cy6oimwmWOq+92q5/fJiPclHezGxnuSjvZhYT/LR3r5Yz0ZbIyyb9dpnjs/edWSvrbi4z8ZsTx73xTh7Z2WojzcMebGe5KO9mFhP8tFeTKwn+WjPxnqNFhEfAOCYGrkRlJU7mjJ/8B3OaCpv4kQcu4bmJAitc4oZNUl+5BQzapLMyIlR0wF2veC+ayO7ZnImTkglRlO5EyekoYymvlga/GMMWWidU8yoSTIjp4hRk+RHTnbU1JsM/95iBAUASBIdFAAgSSMX8dmyKzZiyKKH/IkT0qDivuJ1UuXZ0jgnQWidU0ysJ/lob1+Esb7u220fYQQnRDRKV5k50WwZsP3XQHZtHJw4IYXjvvA6KWlQcV/30ePwTsdMaJ1TVKwnRZUvypsQYWO97jSTJAAAxxQdFAAgSSMX8dlqyjZOyCKG8DopKTfuq32dVHm24vVJMLCq5DXEeo0zFd/oE8ZWF9/HHR4flzUj4r64skhSnXFfb2c7vNMxM+yq5I0J/zssb8aejfW2nwpfS4ygAABJooMCACRp5CI++yVptnvO4oS8mX1Smbiv3oW8MfZ9kd0JUHtV8r1oLyrWk1y0Z2O95ni1GPaksV/amSt3Zp8Umt13lFXQbWx1UgylKrmN9c6d83eRM2PPxnpbF8LdDyMoAECS6KAAAEkauYhvqWuH8QfjvryZfdLwq6BHWTxZNcRqqUqeM2MvJtaTfLRnY70yFZhHwe2ViMr7EXHfUVZBH5uerHS7lA2sKnlErCf5aM/Geu0L4fERIygAQJJGbgS10LGfkuwnrb1PYDkTJ6QSo6kBlkUK6awM93tzBq1yVfLQOqeIUZPkR06xFZhHweLyVLUbhkZTtVdBj3BxptrtElZ7VfK9kVPMqEnyIyc7amrPhsuGMYICACSJDgoAkKSRi/ju7BSt38hissPXSUlHWwU91wn7Qr1hVyUvWueUW4F5iohPkrqL/jhVXb83nCro5e08e77aDRNWe/mivWgvJtaTfLRnY72tWR/lF2EEBQBIEh0UACBJIxfxFVZhdnJm9knBuG/YVdCtxumTVWE7WJXczEwaVKwnmQrMJtbbPU+pI0maeGBmY6nOuK98WSSpRBX0CCtfmqh0u5TVGetJ4arkReucsmjPxnrdS+Hq8YygAABJooMCACRp5CK+T9ZDEZ9VPu47yirozfNPVbthogoX4u5Fe71Ns/iwhqrkRQtxs2jPxnpbF3wMMspa921cdDDuq3dmn9StWAU9xsrz4YWjx05MVfKz/joovCYCVcmLFuJm0Z6N9Z6+bOPcgqcZ3AMAgCNABwUASNLIRXy3VyOqMO9zeNxXexX0GJdPVg2xogrMWbRXd1XyooW4WbRnY732eT7TSdLkXVvvzv4a2VuQWevMPqlqFfQYu1/ZCO90nOVVJY+I9aRwVfKihbhZtGdjvV+9dDv8lIN7AABwBEZuBHX/UcUqzPsMpgr6vj8ER9i8Nl3pdqnKGzVJg6tKXrTOKRs52VFTe+YE/iG9gtatZfM/m0pkv1IGtU5KiqmCHrNq7fe/eqPKM0tb0TqnvZFTzKhJClclL1rnlI2c7Kjpt89/EH76wT0AADgCdFAAgCSNXMS3/dCXM7lfyz0Oqgp6eSvPnay3MWqdUw1VyYvWOWXRno31ti4WrCsZMZ2bH7t2Sy+an2Rx38GJE9Ig4778dVIxEd9fz81XfUbJCq1zqrsqedE6pyzas7He77Xa4ecf3AMAgCNABwUASFKjV1QKAwCAI8QICgCQJDooAECS6KAAAEmigwIAJIkOCgCQJDooAECS/h/ARITHrN7qygAAAABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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t2dxX/7ECamOuC+PvXaqXkfPvBPxxZ91/4obUMm3omORRXsxsZ4UrkpetM4pi/ZsrFd0DlmMoAAASaKDAgAkqdHrpfUFdwAASIygAACJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkuigAABJooMCACSJDgoAkCQ6KABAkk4d9sNf+dc/62Xtb8x96rZ/c+ojSdL18c/dtqtjp1271Tzj2ju9jmvf72xKkm7uPOW2/ef6S6797w9edO2PPptz7XM3+/d3eX7bbTv94/927be7P2gc9jqs5Z9fda/pcdc/t6VO//nf6/jndmd71rU/3brk2+t+++2VC5KkxeUpt627OO7aEw/8Z4DWfffQmry72992a9lt69z82LVjXlN34aVeeK+j15z7WanXZF/Pv2xMuO0/enRdkvRfD77ktt3/wr9fzQf+vBt/6I/7xMP+3U0sd/3Pl3dd+8xjf141VzZdu7G2IUnqbfhtvU3f/tHG31d6j7678Jrb/k8fviJJOnWz5bZN3/Jv5/TttmufvvfI3+HikiSps7JmHsSfz43T/lg0z/tjpMszkqTNa9Nu08pz/tfA/N/+aanXZK+jVsM/1unG2IF9Oz1/3Dd7/livdv17sNTt326hM+m23dnJv/4+Wfft26v96+/+I3/9bT/058xnf/zd0u/Ra3/y/WNxHZV9jyTpxb/yr2l80d9sYmnvmnhkr4kd1z71aMu1m6sbrp13TXS3/L69bf/+qpdzOJv+/Gie8X1G0bXECAoAkCQ6KABAkg6N+E4iG0eoaaIdZcPbx/7nZtcYi6bd1rj5n/08kB36C/65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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GL</span> <span class="o">=</span> <span class="n">GaborLayer</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">orientations</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">use_alphas</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">learn_orientations</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">GL</span><span class="o">.</span><span class="n">build</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>


<span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">GL</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="n">n</span><span class="p">,:,:,</span><span class="n">jj</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAagAAACjCAYAAADfAoq3AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAaSklEQVR4nO2dS6wlx1nHq7vPua8Zz3j8iO3xaxLHTpxEASUyAsSSIEUCIiEhhR0LhGAZBTZZIbYI2MAmCzZIZBGEsosICyCIIEAsiPMgCR7bGcbjGceeh2fmPs7tbhZ9uupf91Sdftxz7607+f02t26dPt3VXdXn6/r3932V1XVtAAAAUiM/6QYAAACEwEABAECSYKAAACBJMFAAAJAkGCgAAEgSDBQAACTJZNmHn/3QF60P+r2Xn7D1dy41X7v3jNt278mZLV94/H1b/vAjP7Hll87eMMYY8/LmW7bu0vQdW75Y3LflR4rCls9m68YYY4osbE/zJ3+ULTsPpXr7RXtO/7Tt9vfPdz9qjDHmv249Z+suv/uoLd97d8uWJ++6y7Z+M5v/de76Gzcr+Xzfltdu7bo237rXFG7dcW27dduWv7H3ld7n9C9vvGAP/kevf87Wv/bdi8YYY87/0F3L86+7ftp80/VTdv1d146bN40xxtT7ru3ZxJ1zfv6cO/gTj9ni9rNN/e0PTm3dHXe5zeUvfLHXOWkf/eWtZ2393179lDHGmDfefNzWbVxZs+Uzb7ljnXm7dNtc3zbGGFO8d9cdRK/7+66+3nV9ZMnd9cvPuHHw97f/qncffSb/Tdu4nV/7OVt//ZVm39nLrg2/9Nxl970L37HlV9av2vIzk01jjDHTzLXtdrVty/87c/Xfuv+iLX/9xseNMcZ8/7WLtu7cq+4avvrnX+h1Ts9/+U/s+Zz7gRsb5y83Y+bMGzK23nK/ATrG69me22Y+vvKHz7vPn3T9fP+SG3O3XnDHu/PR5nif/oS7Zn/2/Nds+dIz13r30eyau4++dONTtv5rP/xkU/jRGVv30Ovue+euuHtq4//cuDLvNPdR7JxN5pqWb7lxlT9ywRhjzP5TF2zdvWfd59/66h+MGne7n33F1t/4dHOP7r3sxszPPnfFln/50e/b8s9vumv7wWnz23Y+37R1s9rdaz8p3f5e3XPt/9d7LxljjPnHt1+ydVdec/375u/9YfCcmEEBAECSYKAAACBJlkp8pnRSVVZJxon6wN8D5bp2s7WqXpy5lYG65OlIuJENTMjRXs9VZPIopHG5NnR+maOXO/Z4EpBS6yrSTml/ew2yyLgYQ1UHGjly/OgYPu4MKirhlOtyf8zV0I2pk1M3CycDbWROPio6TruSc5rVTuLbqd1tPqvm9fvuuhZ7q7sWWfuTEbu+dRWutzuQ/o6Oz0i542s/lYiM6F2Ytlpu1nzoj1iAMlY/v4/VHmQ97mP6EgAAkgQDBQAASbJc4gvIN8a4aXyms/UqLOuFypXYxVLKscl/NdeJisjnQyhFYihlj9V8zqvtjakUQwQmX+5aPoWOymgdTDM3sS5yuYrZgb/GmDqLtD4fcFbazlCbvXNenZxbh/Z1SnIdZ1vO66lck3tifgdOC9eH67l4fkrfOt9IY/LAKCzlYuzJ2L5frtvy9qzZSzYTDzKnIo7jOPqgYxipPLWK34kUWIHiZjLxhtZ7v72V9LLmPeS+YtCv3yJ19J8wzKAAACBJOpwk3NNbVgZmU/pEG/ChMMZ/yV0OsIf6wveQRns1xGZTgfpVPPkMYSpTWX3yqfO5I0bspXJsNjWW+WwqNNseQtn1Ij3GCp0zVk22GZ5B1dOmoWsTd69tRZ0kMik395JeK71q6iSxW7nbfK+cx13JDEoO15/YtT6h2dQqXvBHDzff90kOqdGnp04ngd+BTGdNRmeh4d+UIahSZtWziM2IwQwKAACSBAMFAABJslTiqysRDQLTeN8BQJ0L5CWwzCvb6V1Z69RPJcCj1/IqORFtR8hPP/hS3pjw1PQE5/8aBzXJOpwkvFiIkddbJbiQI80KJZ8yMH5Sk+/6UG86R4VyTernEt+6OklkzkliquWO+2NP+mKndi4VKvHN9huJL1eJb/cILqjqjX0k21AaM32pLx/7knXTdk+eWoF0XYRctlJ41TCQrHAXrlbvkSOKg4oRfL2DxAcAAKcVDBQAACTJci8+iXHJvHL7efhrnamOErGL1ZB2DJH7Yp97ssf8g5GxT4rvxbdc4ovJFJmXEmWs9Hfgb/xwS6lWrOEdt1dliHrDSW6VevFNmv5aL5yUtyGBSRrjlgekK71Wvhefu7W3K6cpzuZefBJqNS7VkfaxVz7kxR469rL2a+qNBpZcJD5PMp173Hq3vRtBhZa9+3F5/+gYDL2y8V6bkOoIAABOKxgoAABIkg6JTwJ1derekbVaN42lPWo5Ds89pYrokqFAstFefGNVjpEBqlP14ssX9+HPqrNgeTSeF99ioO6RZDMXjkO+y8ZKnkIlEp968ZnWi2/iNLd1kfjWjEotIYnPfT6Ta7FTiRdfKV5884UM8z314hs+7vpkol4pPWTqlsOm43mgkFRHJqCuZQNvoHzknCb0+9rn0MygAAAgSTBQAACQJL1z8RnNxWcXJZNteyxY2HrveXVesKxuezTaTSmSlMqLoz0LE/AQKzxPHGlQm4svdmpDgnZVfqwieq6ti5R70iXDRve5Sm+yFVNtultN1DeTT5t7bKNwsp7m3/M8NDvydO9JR2ug7nYp8mLZbDORDOZjJD6PYBD/KlJx95DqrBeferKOk/iKULDwUFad3/KQZJFgZ5eLz1UVniekjrtxfeknZGgOVJOLDwAAHgT6x0GF4h68rNVh54LQbGrobMU9UR/9Si9+28PbDHmvmAWcCJbufAS6TlBXqqMjfX8ccJ4Zk838yDjBWVW5LmuPSYcV8zgobwaVh2dQRbZ4u6oiMJP7ak/ioPYqOfas2UbXgCp2Ygt1L2HIpVzBdQ+tZWSMsYNNn/6PxUkirYlSHG89KKnvymY+0vuo7PhaNVBdYQYFAABJgoECAIAkWZ7NXJ0kAmmPVNaLxkF52agX7aG3qJU3bz4aOUZfwIde4kXpaE5QAu3D2MX5hKnIH36qo1Zzk8PFFiyUlCjti9U+p+GlwGo7/pBOEjFHliCrGCYD0k1lI1+Cl+sy1tZESmlTHeWytLuXwVwlmND9o3FQ7vNd0RF3xEmibiU+WaQw3xmx5ntsvB+yP/T6VgOudd5xnX5q0Ri+mEx6SKJOTdIP7WudmjgoAAB4EMBAAQBAkvSOgwqlOvLoEQfl6rrt4kk5f1UD3XNWmmpnpLfTVOI31OurffwIee805XHz/Fo9E/WD+aFHy51dx7WFFegTK8giP4RyXe4J8eLbmDZy3mbhNDeNgyo6TnVWq8Qnsp548WmqI7O/6MWX70hq81URGcv12OseHcPNH43/W8WChQ8MUe/H9uPwgoW6YONYjz6FOCgAAHigwEABAECSLPfiUylHUx0Fs5nLVLIKS3ytfOanGAqXjwpNoeR5EAZko0HZzGOfe+WjkZU0MDEP6Wt91ggbK4t0pjoavl/1CuojB7dEvckSSHtUyiKFldx106KR0ddlBcE1WaRQg7DzwP2h43lPAtnVi2933x0wmzX70EUKs+3dPqfgs0LPvcF0BJ7jxSdooG5HqqN8BVH13oKFnpf0Ypo7FiwEAIBTCwYKAACSpH8288pN3tqZYCgm1Jh4Lr5yldFhI6k65J5owG5XBu2hMscqc/Flbho/lYDPdvoeC86Ndkc+8rnFLliocvDq+jzYNyev3vVCJb566hq9Nmn6ayvqxScLC4q3Zjn33lNJZVa7cXBfVkXcCUp88sXtnb6n4Yh4Y412+AotCinDsGsYednMT02ivKPHCywPdFnmeT+qR19Y7hviIRl6ZaPDg0BdAAA4tfROdeQZ1NCsoVr82JiDS77n3l9j4umGvHQ39eLL/lXgrUUVsNXRSc4qn9pXEI8zkZfj3tot+eK+vSfRSBqUTirt7EDG+xW+QC8HOEmkjC7zrjOo9dZJQtMbeamOlvfLnlx/XQNqVzwxZvsyPgJOEvX2dmf7B+PlO1vtNLczm/kK1nVSZyOrRBx6ryfAgDioGMWAM485urUOcsRBAQDAAwEGCgAAkmS5k4TKN56TxGLW6lhMlOIWLNTYqOO1kRo3EpqOxpwkul72++FHkUUKjwiVNCaek0RAGj3SBQtbJwk53IjQivJ0iilLqdRJYuIuynrRyHn+IoWuD2PLl1fza+Q7SUh6I4mDmpUi8c3Vw2JX4gHvDZf4YuP90M4/A+Px2s3HLkv+wCNxUKHfAU/x1wULh8h6kT73X+WMc3BiBgUAAEmCgQIAgCTJ6gTSwAAAAByEGRQAACQJBgoAAJIEAwUAAEmCgQIAgCTBQAEAQJJgoAAAIEkwUAAAkCQYKAAASBIMFAAAJAkGCgAAkgQDBQAASYKBAgCAJMFAAQBAkmCgAAAgSTBQAACQJBgoAABIEgwUAAAkCQYKAACSBAMFAABJgoECAIAkwUABAECSYKAAACBJMFAAAJAkGCgAAEgSDBQAACQJBgoAAJIEAwUAAEmCgQIAgCTBQAEAQJJgoAAAIEkwUAAAkCQYKAAASBIMFAAAJAkGCgAAkgQDBQAASYKBAgCAJMFAAQBAkmCgAAAgSTBQAACQJBgoAABIEgwUAAAkCQYKAACSBAMFAABJgoECAIAkwUABAECSYKAAACBJMFAAAJAkGCgAAEgSDBQAACQJBgoAAJIEAwUAAEmCgQIAgCTBQAEAQJJgoAAAIEkwUAAAkCQYKAAASBIMFAAAJAkGCgAAkgQDBQAASYKBAgCAJMFAAQBAkmCgAAAgSTBQAACQJBgoAABIksmyD9+9+nTdln//x79q6//91Q8bY4w5/z339Ydfm9ny1ht33E7efscWq9tNfV2Wti7f2nLlxx6x5dkzj9ry7Q9tGmOMufURt9v1T9yy5e/8+h9ny85D+ZW137LnVO/vL3yeTdw5ZZubrm3nHrLl+mFXnj3WtH/78TVbd+8DhS3ff8oezuw97a7RpWeb6/K5i/9t637n/P/Y8rmLV3qf042rF+1Bzucbtn6aNe0o68rW3a13bfl66erfmD1sy9/bfdoYY8yr7z9j67773pPue9fcthtX3Hk/9HrTjAvfv+sa9x+v2uI/VF/tdU6/8Pk/tedz5uqOO59rTZ/X7920ddXde7as/an9mJ8909RdcO2ePenK95921+zOc67v7n6wGacXX3Rj+HcvfdOWf/ulf+vdR5+ZfN6eU/bpj9n6Wx9p2nbnefesuP2MO48zT7jz+/CjP7Hlj527Zowx5uNbV23dC9Mbtnxxsm3Lj+Wuj7ak3DKr3f24/tTlXue0fe2SPZ/1bLrw+W7txvrtas+W3y7d9b08e8yWf7DzlDHGmO/efcrW/fDmB2z5+vXztjy95s7h7I+bvw9fdsfb/PYVW/76W3/Ru4/+883n7Tn99Xu/aOu/efUFY4wxN6+6Nmy+5cbX5nV3j2+94+6pzRvNvTZ5z/Vhdut9W/bG7rbrr67fpW/sfaX3OX3p279hG/c3337F1p/5TjPmL/xAxtpr7nc7u+bGUnnzttvh/LfE+91+4nFb3rnkfrdvvej66ebHm+998mfesHVf/tDf2fKTT78VPCdmUAAAkCQYKAAASJKlEt87lZu63tlzMki218zGMpmJZvtuW7PvJAMjcl4t+7PkebBcT9yMr5q0dW7TjeniNDgZekzA82zxWuTH/LxQmEB/LKkPUeu59hYeunYqx9cxU/dvV5BMGijF6DnMu2OSO9lmLZOxfVQc8jRTpqqXD5KqzqUc7iS9dWxZxkk9cpxMs0rKrp+z9iB9xowJbKPjLj/ee3wjd9JnXsg1ytu/2jb5YhY7qdr/e6CcVVqW3ZXN/nZK9yN+L2QPDsAMCgAAkgQDBQAASbJU4nuvdLLe/ZnzyMjnEl8xc1O0XMoq6/kSjcz55mQylawLmd4XKvfN6yZuXxuThCU+xZMC0tVuimyxb1SGzDxdRTaSeitpqGwQkwqW4EkDISlB5ZweMkH4IDLuci3L4fJm34VIfCqZQD/KHpJbWS8+K9eexGeWlr1ba+SYUGlbx36RB/YXG9bevbF87Hu/fR1tGzvOt3LnQZkF7lXvsqv8mOVSlHYu/kwYU7nKrFR5XnY3NwmzSjyca1eOwQwKAACSZOkM6kbp4n3uz1ysQ76/6CSRz9SKunJVBl4qZ+oYEX6BGHKSqCTcYmvqngxOM0McEk4LtTwZZtnwZ6Do0/D8SXzwS/B5G7yZUuQlt/dEOa+feC/PR87cg4+eJjwDOAWswqEnNGtSx4jopCHgJJF1KDV9UCeJQh7/7WwqoiJEfDlk21V5Dw1n3XOScOfknCTctt5927VjmTXFHJly+elvnSRmEgd3r15qfpp9dG4BAABwAmCgAAAgSTqcJM7a8vae09ey+axRnSRU1vPioEIvuT15RWyk5yShEl9Trqduv2enLmVPCnSEdywQioMqjkEKKHoEK+UBhwmPkGOEMa5f1UciH35OfixFJCbKNmCAnOPFQXXLfe15qpPE1KwgDuqw8VwDqcw4yeswxBwjysj4q+b1VTSoyBW9W6de/NyU48435iQxNg4q+Pgfu8dHSOF9OJO738lCJb650haNg+q4b+uhcVDz8p5IfPer9aXHONgkAACAZMBAAQBAkiyX+PadxDebualZPmumf7mkN8r21atDppIhLz5F452KQsoiwbStlDiohxKT+Dxis/iTc+YZhUp9IUnyIENlzviOtByKgxoo4bRyRRaWM3xPJrOwzSSROKio/HVKUbmvOw4qVm7GhB8vN07i0xZoqqM8IPH5MncshVa28LnXgyPk76FsZG68qsS3H/DiUy/qzDunjnlMVOLTV0CtF5/b1069mAX/IMygAAAgSTBQAACQJEslvtulW7Bvf+Y2XZ/PGj2JTz1nYqmO2m3zyPRRPfemWp5vuuaOcX7qFvg6KrIemlzdtU3Hx50ec0eIPp0MCRj2TrkrMHFMoK6qwqHL08cLLnRcz3MvIst4kkdznLXcBeeurcKL76eMIVdMA3VjqY7C2cy9nQxpnkV+crzUX7a6y3v1YH2IY9b5t8SLT6XqvXlm86i83dVOz7s2HLQb8uLb10BdvPgAAOC0goECAIAkWSrx3Zy5defLPWfLWsVDpRj14qtV7gt51GimXA3OnWjZbd4mwM2nIvFNjl7iO27G5jc7DpGwlzDRZkj2POFGBOqqV1AkIHDYDgNt8GS9sNzXSnyeF9/YXHxHRLky18njQT33vMUJ20BdLxdf/2zmOjbGLlioubXzUNBuIE/jYjkwlk5wGqBefNOJLB4bCNTV1ST8hWQDY0x/1wcsWFhWbr/3KrdCRgxmUAAAkCRLZ1Dv77v1oMxscQala0D5cVBdy7zr20iNfdKYqEUniYks835hcm9Z01dP7AX7SPJjzGJeqMNAj8O2mZyLWOxTdG2owKZjrlUsDioU/zTEYSIP96H3oO4tiTOfQcmj4PpxLPkurDorUlm3fZv+s6l36h0OE95Q7Yq9jDCVMTEVxxib6qpHNvPU0FRH00KuSzAOatw6bt6MVdaD0rWh2luo9OKgmEEBAMApBQMFAABJslzimzk/9Uwlvvl7N39538gCVgE82cdbpNCVSy8Oqtnf+pqbdj9S3F16jGOnz5Q4lMFcF0ZLOJVNLNXRUSzQ5oWGjU11FHqx6y3zboJlfWTL5rEi6xoHNTZu7ZgzmKeEH6Ik97hc7DbVUdVDLwtmM4/F5QxAM/2HMptnPWQ9PyNTKMVWJEYwJK+tIH3TGXWSEGef8IKF8kV53dK5NL06RngOTm6TVhnfL92+7uMkAQAApxUMFAAAJMlSie+uJ/FJRt55iqN8pumNIqmOQlNT8dwzE/Him4bjoNqktxvixffoJDGJT4glXj4O/MXpiuh2BwmlXIp6GnbJG5EMyb3xPPeGf32BYDbzWKojkShsHJQbz+ur6M+QDOJ5pqUr9bbE5OjWS3DoIomttKcSYCzVUdiL7/BxUFOR3IKZ/Pt4r4bKJ7iMwZbI0+rFV9tUR15+J1eOvIax368i8qMXE6VfaP5UEge1W5HNHAAATikYKAAASJKlEt/9mfOyUInPBupGvPiiU+x22qiee5rqSAN1NdXRfKHCranzSHk0P+ZA3RWT9VgA8KToszihJZQFJYtIBX136Uk446Qb9Txqy5UughkJzq09x6pFL76N07bqZMKE0jTpoox11FUuUFbJaWSgrqYa8xYsbA/SI4N5ctnM5WZaL9w4tqmO5C1AHQvU7WpzLFBX+qRVyWu8+AAA4EEAAwUAAEmyVOLbnjkvC1E5XDbzyIKFdSxQbu4loxnM1aNPFyn0AnXnCxWeXXN5pR4pdpY1/fgYMmMPbKty2nHnRysGtF3bGZUnQ/sb48XXEejdKSEfPG4gYNLL4hyR+FovPpV7NrL+npGwSBnz/gs8K9chKc8ckIDnYyXznMrGevG5vtUA+jYXn4577wgd0l80d+eITP9DUUlaF94MefFFJb4uYoG6gYVHa83FhxcfAACcVpbOoHZkmXddBqe1jFksvUjkCdcu9R6Lg9KX2BoHtdbs7+zUzaAeH/n0MfbpajTH8E60HOA8MGTNqV7L0YdeEHsPYodzkvBjokb2XTubiizz7q8B5YpF0Zy/OkmsZ91PfcdBaMaRKmWk26rAOcSWfM+6ln9fQVogje1SxcDFQcnGHVn8519crIvcD53phEayJeN1owjMoPQ31ytH1oYa4DARWhtKnSR2q6Xmpzl05xYAAAAnAAYKAACSZOkcazZz8lvuxUHNXxqWkVRHHU4SJhdZT5d59zKYayub/Z2fumXeLxRbJiXqPlN+oZUNimNZsL0b76VwoE1ZbLG2wL4OvaBjTOIbQiCOo+7jJOH5WSzGQU0TdpKIOSCkREyadKmOesQ+hepVRxy75Ls4Ka3JO41QNvM+cVDB1F/HzFbuYo00Diq0YGHMSaJTpo+kOvKk2HaTyu1rD4kPAABOKxgoAABIkmxs5l8AAICjhBkUAAAkCQYKAACSBAMFAABJgoECAIAkwUABAECSYKAAACBJ/h+5NisSuuxbsgAAAABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAagAAACjCAYAAADfAoq3AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAaSklEQVR4nO2dS6wlx1nHq7vPua8Zz3j8iO3xaxLHTpxEASUyAsSSIEUCIiEhhR0LhGAZBTZZIbYI2MAmCzZIZBGEsosICyCIIEAsiPMgCR7bGcbjGceeh2fmPs7tbhZ9uupf91Sdftxz7607+f02t26dPt3VXdXn6/r3932V1XVtAAAAUiM/6QYAAACEwEABAECSYKAAACBJMFAAAJAkGCgAAEgSDBQAACTJZNmHn/3QF60P+r2Xn7D1dy41X7v3jNt278mZLV94/H1b/vAjP7Hll87eMMYY8/LmW7bu0vQdW75Y3LflR4rCls9m68YYY4osbE/zJ3+ULTsPpXr7RXtO/7Tt9vfPdz9qjDHmv249Z+suv/uoLd97d8uWJ++6y7Z+M5v/de76Gzcr+Xzfltdu7bo237rXFG7dcW27dduWv7H3ld7n9C9vvGAP/kevf87Wv/bdi8YYY87/0F3L86+7ftp80/VTdv1d146bN40xxtT7ru3ZxJ1zfv6cO/gTj9ni9rNN/e0PTm3dHXe5zeUvfLHXOWkf/eWtZ2393179lDHGmDfefNzWbVxZs+Uzb7ljnXm7dNtc3zbGGFO8d9cdRK/7+66+3nV9ZMnd9cvPuHHw97f/qncffSb/Tdu4nV/7OVt//ZVm39nLrg2/9Nxl970L37HlV9av2vIzk01jjDHTzLXtdrVty/87c/Xfuv+iLX/9xseNMcZ8/7WLtu7cq+4avvrnX+h1Ts9/+U/s+Zz7gRsb5y83Y+bMGzK23nK/ATrG69me22Y+vvKHz7vPn3T9fP+SG3O3XnDHu/PR5nif/oS7Zn/2/Nds+dIz13r30eyau4++dONTtv5rP/xkU/jRGVv30Ovue+euuHtq4//cuDLvNPdR7JxN5pqWb7lxlT9ywRhjzP5TF2zdvWfd59/66h+MGne7n33F1t/4dHOP7r3sxszPPnfFln/50e/b8s9vumv7wWnz23Y+37R1s9rdaz8p3f5e3XPt/9d7LxljjPnHt1+ydVdec/375u/9YfCcmEEBAECSYKAAACBJlkp8pnRSVVZJxon6wN8D5bp2s7WqXpy5lYG65OlIuJENTMjRXs9VZPIopHG5NnR+maOXO/Z4EpBS6yrSTml/ew2yyLgYQ1UHGjly/OgYPu4MKirhlOtyf8zV0I2pk1M3CycDbWROPio6TruSc5rVTuLbqd1tPqvm9fvuuhZ7q7sWWfuTEbu+dRWutzuQ/o6Oz0i542s/lYiM6F2Ytlpu1nzoj1iAMlY/v4/VHmQ97mP6EgAAkgQDBQAASbJc4gvIN8a4aXyms/UqLOuFypXYxVLKscl/NdeJisjnQyhFYihlj9V8zqvtjakUQwQmX+5aPoWOymgdTDM3sS5yuYrZgb/GmDqLtD4fcFbazlCbvXNenZxbh/Z1SnIdZ1vO66lck3tifgdOC9eH67l4fkrfOt9IY/LAKCzlYuzJ2L5frtvy9qzZSzYTDzKnIo7jOPqgYxipPLWK34kUWIHiZjLxhtZ7v72V9LLmPeS+YtCv3yJ19J8wzKAAACBJOpwk3NNbVgZmU/pEG/ChMMZ/yV0OsIf6wveQRns1xGZTgfpVPPkMYSpTWX3yqfO5I0bspXJsNjWW+WwqNNseQtn1Ij3GCp0zVk22GZ5B1dOmoWsTd69tRZ0kMik395JeK71q6iSxW7nbfK+cx13JDEoO15/YtT6h2dQqXvBHDzff90kOqdGnp04ngd+BTGdNRmeh4d+UIahSZtWziM2IwQwKAACSBAMFAABJslTiqysRDQLTeN8BQJ0L5CWwzCvb6V1Z69RPJcCj1/IqORFtR8hPP/hS3pjw1PQE5/8aBzXJOpwkvFiIkddbJbiQI80KJZ8yMH5Sk+/6UG86R4VyTernEt+6OklkzkliquWO+2NP+mKndi4VKvHN9huJL1eJb/cILqjqjX0k21AaM32pLx/7knXTdk+eWoF0XYRctlJ41TCQrHAXrlbvkSOKg4oRfL2DxAcAAKcVDBQAACTJci8+iXHJvHL7efhrnamOErGL1ZB2DJH7Yp97ssf8g5GxT4rvxbdc4ovJFJmXEmWs9Hfgb/xwS6lWrOEdt1dliHrDSW6VevFNmv5aL5yUtyGBSRrjlgekK71Wvhefu7W3K6cpzuZefBJqNS7VkfaxVz7kxR469rL2a+qNBpZcJD5PMp173Hq3vRtBhZa9+3F5/+gYDL2y8V6bkOoIAABOKxgoAABIkg6JTwJ1derekbVaN42lPWo5Ds89pYrokqFAstFefGNVjpEBqlP14ssX9+HPqrNgeTSeF99ioO6RZDMXjkO+y8ZKnkIlEp968ZnWi2/iNLd1kfjWjEotIYnPfT6Ta7FTiRdfKV5884UM8z314hs+7vpkol4pPWTqlsOm43mgkFRHJqCuZQNvoHzknCb0+9rn0MygAAAgSTBQAACQJL1z8RnNxWcXJZNteyxY2HrveXVesKxuezTaTSmSlMqLoz0LE/AQKzxPHGlQm4svdmpDgnZVfqwieq6ti5R70iXDRve5Sm+yFVNtultN1DeTT5t7bKNwsp7m3/M8NDvydO9JR2ug7nYp8mLZbDORDOZjJD6PYBD/KlJx95DqrBeferKOk/iKULDwUFad3/KQZJFgZ5eLz1UVniekjrtxfeknZGgOVJOLDwAAHgT6x0GF4h68rNVh54LQbGrobMU9UR/9Si9+28PbDHmvmAWcCJbufAS6TlBXqqMjfX8ccJ4Zk838yDjBWVW5LmuPSYcV8zgobwaVh2dQRbZ4u6oiMJP7ak/ioPYqOfas2UbXgCp2Ygt1L2HIpVzBdQ+tZWSMsYNNn/6PxUkirYlSHG89KKnvymY+0vuo7PhaNVBdYQYFAABJgoECAIAkWZ7NXJ0kAmmPVNaLxkF52agX7aG3qJU3bz4aOUZfwIde4kXpaE5QAu3D2MX5hKnIH36qo1Zzk8PFFiyUlCjti9U+p+GlwGo7/pBOEjFHliCrGCYD0k1lI1+Cl+sy1tZESmlTHeWytLuXwVwlmND9o3FQ7vNd0RF3xEmibiU+WaQw3xmx5ntsvB+yP/T6VgOudd5xnX5q0Ri+mEx6SKJOTdIP7WudmjgoAAB4EMBAAQBAkvSOgwqlOvLoEQfl6rrt4kk5f1UD3XNWmmpnpLfTVOI31OurffwIee805XHz/Fo9E/WD+aFHy51dx7WFFegTK8giP4RyXe4J8eLbmDZy3mbhNDeNgyo6TnVWq8Qnsp548WmqI7O/6MWX70hq81URGcv12OseHcPNH43/W8WChQ8MUe/H9uPwgoW6YONYjz6FOCgAAHigwEABAECSLPfiUylHUx0Fs5nLVLIKS3ytfOanGAqXjwpNoeR5EAZko0HZzGOfe+WjkZU0MDEP6Wt91ggbK4t0pjoavl/1CuojB7dEvckSSHtUyiKFldx106KR0ddlBcE1WaRQg7DzwP2h43lPAtnVi2933x0wmzX70EUKs+3dPqfgs0LPvcF0BJ7jxSdooG5HqqN8BVH13oKFnpf0Ypo7FiwEAIBTCwYKAACSpH8288pN3tqZYCgm1Jh4Lr5yldFhI6k65J5owG5XBu2hMscqc/Flbho/lYDPdvoeC86Ndkc+8rnFLliocvDq+jzYNyev3vVCJb566hq9Nmn6ayvqxScLC4q3Zjn33lNJZVa7cXBfVkXcCUp88sXtnb6n4Yh4Y412+AotCinDsGsYednMT02ivKPHCywPdFnmeT+qR19Y7hviIRl6ZaPDg0BdAAA4tfROdeQZ1NCsoVr82JiDS77n3l9j4umGvHQ39eLL/lXgrUUVsNXRSc4qn9pXEI8zkZfj3tot+eK+vSfRSBqUTirt7EDG+xW+QC8HOEmkjC7zrjOo9dZJQtMbeamOlvfLnlx/XQNqVzwxZvsyPgJOEvX2dmf7B+PlO1vtNLczm/kK1nVSZyOrRBx6ryfAgDioGMWAM485urUOcsRBAQDAAwEGCgAAkmS5k4TKN56TxGLW6lhMlOIWLNTYqOO1kRo3EpqOxpwkul72++FHkUUKjwiVNCaek0RAGj3SBQtbJwk53IjQivJ0iilLqdRJYuIuynrRyHn+IoWuD2PLl1fza+Q7SUh6I4mDmpUi8c3Vw2JX4gHvDZf4YuP90M4/A+Px2s3HLkv+wCNxUKHfAU/x1wULh8h6kT73X+WMc3BiBgUAAEmCgQIAgCTJ6gTSwAAAAByEGRQAACQJBgoAAJIEAwUAAEmCgQIAgCTBQAEAQJJgoAAAIEkwUAAAkCQYKAAASBIMFAAAJAkGCgAAkgQDBQAASYKBAgCAJMFAAQBAkmCgAAAgSTBQAACQJBgoAABIEgwUAAAkCQYKAACSBAMFAABJgoECAIAkwUABAECSYKAAACBJMFAAAJAkGCgAAEgSDBQAACQJBgoAAJIEAwUAAEmCgQIAgCTBQAEAQJJgoAAAIEkwUAAAkCQYKAAASBIMFAAAJAkGCgAAkgQDBQAASYKBAgCAJMFAAQBAkmCgAAAgSTBQAACQJBgoAABIEgwUAAAkCQYKAACSBAMFAABJgoECAIAkwUABAECSYKAAACBJMFAAAJAkGCgAAEgSDBQAACQJBgoAAJIEAwUAAEmCgQIAgCTBQAEAQJJgoAAAIEkwUAAAkCQYKAAASBIMFAAAJAkGCgAAkgQDBQAASYKBAgCAJMFAAQBAkmCgAAAgSTBQAACQJBgoAABIksmyD9+9+nTdln//x79q6//91Q8bY4w5/z339Ydfm9ny1ht33E7efscWq9tNfV2Wti7f2nLlxx6x5dkzj9ry7Q9tGmOMufURt9v1T9yy5e/8+h9ny85D+ZW137LnVO/vL3yeTdw5ZZubrm3nHrLl+mFXnj3WtH/78TVbd+8DhS3ff8oezuw97a7RpWeb6/K5i/9t637n/P/Y8rmLV3qf042rF+1Bzucbtn6aNe0o68rW3a13bfl66erfmD1sy9/bfdoYY8yr7z9j67773pPue9fcthtX3Hk/9HrTjAvfv+sa9x+v2uI/VF/tdU6/8Pk/tedz5uqOO59rTZ/X7920ddXde7as/an9mJ8909RdcO2ePenK95921+zOc67v7n6wGacXX3Rj+HcvfdOWf/ulf+vdR5+ZfN6eU/bpj9n6Wx9p2nbnefesuP2MO48zT7jz+/CjP7Hlj527Zowx5uNbV23dC9Mbtnxxsm3Lj+Wuj7ak3DKr3f24/tTlXue0fe2SPZ/1bLrw+W7txvrtas+W3y7d9b08e8yWf7DzlDHGmO/efcrW/fDmB2z5+vXztjy95s7h7I+bvw9fdsfb/PYVW/76W3/Ru4/+883n7Tn99Xu/aOu/efUFY4wxN6+6Nmy+5cbX5nV3j2+94+6pzRvNvTZ5z/Vhdut9W/bG7rbrr67fpW/sfaX3OX3p279hG/c3337F1p/5TjPmL/xAxtpr7nc7u+bGUnnzttvh/LfE+91+4nFb3rnkfrdvvej66ebHm+998mfesHVf/tDf2fKTT78VPCdmUAAAkCQYKAAASJKlEt87lZu63tlzMki218zGMpmJZvtuW7PvJAMjcl4t+7PkebBcT9yMr5q0dW7TjeniNDgZekzA82zxWuTH/LxQmEB/LKkPUeu59hYeunYqx9cxU/dvV5BMGijF6DnMu2OSO9lmLZOxfVQc8jRTpqqXD5KqzqUc7iS9dWxZxkk9cpxMs0rKrp+z9iB9xowJbKPjLj/ee3wjd9JnXsg1ytu/2jb5YhY7qdr/e6CcVVqW3ZXN/nZK9yN+L2QPDsAMCgAAkgQDBQAASbJU4nuvdLLe/ZnzyMjnEl8xc1O0XMoq6/kSjcz55mQylawLmd4XKvfN6yZuXxuThCU+xZMC0tVuimyxb1SGzDxdRTaSeitpqGwQkwqW4EkDISlB5ZweMkH4IDLuci3L4fJm34VIfCqZQD/KHpJbWS8+K9eexGeWlr1ba+SYUGlbx36RB/YXG9bevbF87Hu/fR1tGzvOt3LnQZkF7lXvsqv8mOVSlHYu/kwYU7nKrFR5XnY3NwmzSjyca1eOwQwKAACSZOkM6kbp4n3uz1ysQ76/6CSRz9SKunJVBl4qZ+oYEX6BGHKSqCTcYmvqngxOM0McEk4LtTwZZtnwZ6Do0/D8SXzwS/B5G7yZUuQlt/dEOa+feC/PR87cg4+eJjwDOAWswqEnNGtSx4jopCHgJJF1KDV9UCeJQh7/7WwqoiJEfDlk21V5Dw1n3XOScOfknCTctt5927VjmTXFHJly+elvnSRmEgd3r15qfpp9dG4BAABwAmCgAAAgSTqcJM7a8vae09ey+axRnSRU1vPioEIvuT15RWyk5yShEl9Trqduv2enLmVPCnSEdywQioMqjkEKKHoEK+UBhwmPkGOEMa5f1UciH35OfixFJCbKNmCAnOPFQXXLfe15qpPE1KwgDuqw8VwDqcw4yeswxBwjysj4q+b1VTSoyBW9W6de/NyU48435iQxNg4q+Pgfu8dHSOF9OJO738lCJb650haNg+q4b+uhcVDz8p5IfPer9aXHONgkAACAZMBAAQBAkiyX+PadxDebualZPmumf7mkN8r21atDppIhLz5F452KQsoiwbStlDiohxKT+Dxis/iTc+YZhUp9IUnyIENlzviOtByKgxoo4bRyRRaWM3xPJrOwzSSROKio/HVKUbmvOw4qVm7GhB8vN07i0xZoqqM8IPH5MncshVa28LnXgyPk76FsZG68qsS3H/DiUy/qzDunjnlMVOLTV0CtF5/b1069mAX/IMygAAAgSTBQAACQJEslvtulW7Bvf+Y2XZ/PGj2JTz1nYqmO2m3zyPRRPfemWp5vuuaOcX7qFvg6KrIemlzdtU3Hx50ec0eIPp0MCRj2TrkrMHFMoK6qwqHL08cLLnRcz3MvIst4kkdznLXcBeeurcKL76eMIVdMA3VjqY7C2cy9nQxpnkV+crzUX7a6y3v1YH2IY9b5t8SLT6XqvXlm86i83dVOz7s2HLQb8uLb10BdvPgAAOC0goECAIAkWSrx3Zy5defLPWfLWsVDpRj14qtV7gt51GimXA3OnWjZbd4mwM2nIvFNjl7iO27G5jc7DpGwlzDRZkj2POFGBOqqV1AkIHDYDgNt8GS9sNzXSnyeF9/YXHxHRLky18njQT33vMUJ20BdLxdf/2zmOjbGLlioubXzUNBuIE/jYjkwlk5wGqBefNOJLB4bCNTV1ST8hWQDY0x/1wcsWFhWbr/3KrdCRgxmUAAAkCRLZ1Dv77v1oMxscQala0D5cVBdy7zr20iNfdKYqEUniYks835hcm9Z01dP7AX7SPJjzGJeqMNAj8O2mZyLWOxTdG2owKZjrlUsDioU/zTEYSIP96H3oO4tiTOfQcmj4PpxLPkurDorUlm3fZv+s6l36h0OE95Q7Yq9jDCVMTEVxxib6qpHNvPU0FRH00KuSzAOatw6bt6MVdaD0rWh2luo9OKgmEEBAMApBQMFAABJslzimzk/9Uwlvvl7N39538gCVgE82cdbpNCVSy8Oqtnf+pqbdj9S3F16jGOnz5Q4lMFcF0ZLOJVNLNXRUSzQ5oWGjU11FHqx6y3zboJlfWTL5rEi6xoHNTZu7ZgzmKeEH6Ik97hc7DbVUdVDLwtmM4/F5QxAM/2HMptnPWQ9PyNTKMVWJEYwJK+tIH3TGXWSEGef8IKF8kV53dK5NL06RngOTm6TVhnfL92+7uMkAQAApxUMFAAAJMlSie+uJ/FJRt55iqN8pumNIqmOQlNT8dwzE/Him4bjoNqktxvixffoJDGJT4glXj4O/MXpiuh2BwmlXIp6GnbJG5EMyb3xPPeGf32BYDbzWKojkShsHJQbz+ur6M+QDOJ5pqUr9bbE5OjWS3DoIomttKcSYCzVUdiL7/BxUFOR3IKZ/Pt4r4bKJ7iMwZbI0+rFV9tUR15+J1eOvIax368i8qMXE6VfaP5UEge1W5HNHAAATikYKAAASJKlEt/9mfOyUInPBupGvPiiU+x22qiee5rqSAN1NdXRfKHCranzSHk0P+ZA3RWT9VgA8KToszihJZQFJYtIBX136Uk446Qb9Txqy5UughkJzq09x6pFL76N07bqZMKE0jTpoox11FUuUFbJaWSgrqYa8xYsbA/SI4N5ctnM5WZaL9w4tqmO5C1AHQvU7WpzLFBX+qRVyWu8+AAA4EEAAwUAAEmyVOLbnjkvC1E5XDbzyIKFdSxQbu4loxnM1aNPFyn0AnXnCxWeXXN5pR4pdpY1/fgYMmMPbKty2nHnRysGtF3bGZUnQ/sb48XXEejdKSEfPG4gYNLL4hyR+FovPpV7NrL+npGwSBnz/gs8K9chKc8ckIDnYyXznMrGevG5vtUA+jYXn4577wgd0l80d+eITP9DUUlaF94MefFFJb4uYoG6gYVHa83FhxcfAACcVpbOoHZkmXddBqe1jFksvUjkCdcu9R6Lg9KX2BoHtdbs7+zUzaAeH/n0MfbpajTH8E60HOA8MGTNqV7L0YdeEHsPYodzkvBjokb2XTubiizz7q8B5YpF0Zy/OkmsZ91PfcdBaMaRKmWk26rAOcSWfM+6ln9fQVogje1SxcDFQcnGHVn8519crIvcD53phEayJeN1owjMoPQ31ytH1oYa4DARWhtKnSR2q6Xmpzl05xYAAAAnAAYKAACSZOkcazZz8lvuxUHNXxqWkVRHHU4SJhdZT5d59zKYayub/Z2fumXeLxRbJiXqPlN+oZUNimNZsL0b76VwoE1ZbLG2wL4OvaBjTOIbQiCOo+7jJOH5WSzGQU0TdpKIOSCkREyadKmOesQ+hepVRxy75Ls4Ka3JO41QNvM+cVDB1F/HzFbuYo00Diq0YGHMSaJTpo+kOvKk2HaTyu1rD4kPAABOKxgoAABIkmxs5l8AAICjhBkUAAAkCQYKAACSBAMFAABJgoECAIAkwUABAECSYKAAACBJ/h+5NisSuuxbsgAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GaborLayer.get_config" class="doc_header"><code>GaborLayer.get_config</code><a href="https://github.com/SRSteinkamp/pwc_gabor_layer/tree/main/pwc_gabor_layer/core.py#L158" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GaborLayer.get_config</code>()</p>
</blockquote>
<p>Returns the config of the layer.</p>
<p>A layer config is a Python dictionary (serializable)
containing the configuration of a layer.
The same layer can be reinstantiated later
(without its trained weights) from this configuration.</p>
<p>The config of a layer does not include connectivity
information, nor the layer class name. These are handled
by <code>Network</code> (one layer of abstraction above).</p>
<p>Returns:
    Python dictionary.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GL</span><span class="o">.</span><span class="n">get_config</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Implementing-Regularizer">Implementing Regularizer<a class="anchor-link" href="#Implementing-Regularizer"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SigmaRegularizer" class="doc_header"><code>class</code> <code>SigmaRegularizer</code><a href="https://github.com/SRSteinkamp/pwc_gabor_layer/tree/main/pwc_gabor_layer/core.py#L181" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SigmaRegularizer</code>(<strong><code>factor</code></strong>) :: <code>Regularizer</code></p>
</blockquote>
<p>Regularizer base class.</p>
<p>Regularizers allow you to apply penalties on layer parameters or layer
activity during optimization. These penalties are summed into the loss
function that the network optimizes.</p>
<p>Regularization penalties are applied on a per-layer basis. The exact API will
depend on the layer, but many layers (e.g. <code>Dense</code>, <code>Conv1D</code>, <code>Conv2D</code> and
<code>Conv3D</code>) have a unified API.</p>
<p>These layers expose 3 keyword arguments:</p>
<ul>
<li><code>kernel_regularizer</code>: Regularizer to apply a penalty on the layer's kernel</li>
<li><code>bias_regularizer</code>: Regularizer to apply a penalty on the layer's bias</li>
<li><code>activity_regularizer</code>: Regularizer to apply a penalty on the layer's output</li>
</ul>
<p>All layers (including custom layers) expose <code>activity_regularizer</code> as a
settable property, whether or not it is in the constructor arguments.</p>
<p>The value returned by the <code>activity_regularizer</code> is divided by the input
batch size so that the relative weighting between the weight regularizers and
the activity regularizers does not change with the batch size.</p>
<p>You can access a layer's regularization penalties by calling <code>layer.losses</code>
after calling the layer on inputs.</p>
<h2 id="Example">Example<a class="anchor-link" href="#Example"> </a></h2><blockquote><blockquote><blockquote><p>layer = tf.keras.layers.Dense(
...     5, input_dim=5,
...     kernel_initializer='ones',
...     kernel_regularizer=tf.keras.regularizers.L1(0.01),
...     activity_regularizer=tf.keras.regularizers.L2(0.01))
tensor = tf.ones(shape=(5, 5)) * 2.0
out = layer(tensor)</p>
<h1 id="The-kernel-regularization-term-is-0.25">The kernel regularization term is 0.25<a class="anchor-link" href="#The-kernel-regularization-term-is-0.25"> </a></h1><h1 id="The-activity-regularization-term-(after-dividing-by-the-batch-size)-is-5">The activity regularization term (after dividing by the batch size) is 5<a class="anchor-link" href="#The-activity-regularization-term-(after-dividing-by-the-batch-size)-is-5"> </a></h1><p>tf.math.reduce_sum(layer.losses)</p>
<p>&lt;tf.Tensor: shape=(), dtype=float32, numpy=5.25&gt;</p>
</blockquote>
</blockquote>
</blockquote>
<h2 id="Available-penalties">Available penalties<a class="anchor-link" href="#Available-penalties"> </a></h2><div class="highlight"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>  <span class="c1"># L1 Regularization Penalty</span>
<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L2</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># L2 Regularization Penalty</span>
<span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1L2</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>  <span class="c1"># L1 + L2 penalties</span>
</pre></div>
<h2 id="Directly-calling-a-regularizer">Directly calling a regularizer<a class="anchor-link" href="#Directly-calling-a-regularizer"> </a></h2><p>Compute a regularization loss on a tensor by directly calling a regularizer
as if it is a one-argument function.</p>
<p>E.g.</p>
<blockquote><blockquote><blockquote><p>regularizer = tf.keras.regularizers.L2(2.)
tensor = tf.ones(shape=(5, 5))
regularizer(tensor)</p>
<p>&lt;tf.Tensor: shape=(), dtype=float32, numpy=50.0&gt;</p>
</blockquote>
</blockquote>
</blockquote>
<h2 id="Developing-new-regularizers">Developing new regularizers<a class="anchor-link" href="#Developing-new-regularizers"> </a></h2><p>Any function that takes in a weight matrix and returns a scalar
tensor can be used as a regularizer, e.g.:</p>
<blockquote><blockquote><blockquote><p>@tf.keras.utils.register_keras_serializable(package='Custom', name='l1')
... def l1_reg(weight_matrix):
...    return 0.01 * tf.math.reduce_sum(tf.math.abs(weight_matrix))
...
layer = tf.keras.layers.Dense(5, input_dim=5,
...     kernel_initializer='ones', kernel_regularizer=l1_reg)
tensor = tf.ones(shape=(5, 5))
out = layer(tensor)
layer.losses
[&lt;tf.Tensor: shape=(), dtype=float32, numpy=0.25&gt;]</p>
</blockquote>
</blockquote>
</blockquote>
<p>Alternatively, you can write your custom regularizers in an
object-oriented way by extending this regularizer base class, e.g.:</p>
<blockquote><blockquote><blockquote><p>@tf.keras.utils.register_keras_serializable(package='Custom', name='l2')
... class L2Regularizer(tf.keras.regularizers.Regularizer):
...   def <strong>init</strong>(self, l2=0.):  # pylint: disable=redefined-outer-name
...     self.l2 = l2
...
...   def <strong>call</strong>(self, x):
...     return self.l2 * tf.math.reduce_sum(tf.math.square(x))
...
...   def get_config(self):
...     return {'l2': float(self.l2)}
...
layer = tf.keras.layers.Dense(
...   5, input_dim=5, kernel_initializer='ones',
...   kernel_regularizer=L2Regularizer(l2=0.5))</p>
<p>tensor = tf.ones(shape=(5, 5))
out = layer(tensor)
layer.losses
[&lt;tf.Tensor: shape=(), dtype=float32, numpy=12.5&gt;]</p>
</blockquote>
</blockquote>
</blockquote>
<h3 id="A-note-on-serialization-and-deserialization:">A note on serialization and deserialization:<a class="anchor-link" href="#A-note-on-serialization-and-deserialization:"> </a></h3><p>Registering the regularizers as serializable is optional if you are just
training and executing models, exporting to and from SavedModels, or saving
and loading weight checkpoints.</p>
<p>Registration is required for Keras <code>model_to_estimator</code>, saving and
loading models to HDF5 formats, Keras model cloning, some visualization
utilities, and exporting models to and from JSON. If using this functionality,
you must make sure any python process running your model has also defined
and registered your custom regularizer.</p>
<p><code>tf.keras.utils.register_keras_serializable</code> is only available in TF 2.1 and
beyond. In earlier versions of TensorFlow you must pass your custom
regularizer to the <code>custom_objects</code> argument of methods that expect custom
regularizers to be registered as serializable.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
Converted 01_alexnet.ipynb.
Converted experiments.ipynb.
Converted index.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

